#!/bin/bash

HOSTNAME=$(hostname)
ROLE=${1}
SRC_DIRECTORY="${HOME}/src"
LIB_DIRECTORY="${HOME}/lib"
ANSIBLE_DIRECTORY="${LIB_DIRECTORY}/ansible"
ANSIBLE_PLAYBOOKS_DIRECTORY="${SRC_DIRECTORY}/ansible-playbooks"

if [[ "${ROLE}" == "" ]]; then
    echo "Usage: run-role <role>"
    exit -1
fi

set -e

echo "Provision with Ansible"
cd ${ANSIBLE_PLAYBOOKS_DIRECTORY}
ansible-playbook playbooks/role.yml -e "hostname=${HOSTNAME}" -e "role=${ROLE}"
