---
- name: ensure hostname var is defined
  command: 'false'
  when: not hostname

- name: ensure hostname is {{hostname}}
  become: yes
  shell: scutil --set HostName {{hostname}}

- name: ensure localhostname is {{hostname}}
  become: yes
  shell: scutil --set LocalHostName {{hostname}}

- name: ensure computer name is {{hostname}}
  become: yes
  shell: scutil --set ComputerName {{hostname}}

- name: ensure Homebrew is tapped to homebrew/completions
  homebrew_tap: tap=homebrew/completions state=present

- name: ensure Homebrew itself and installed packages are the latest
  homebrew: state=latest update_homebrew=yes upgrade_all=yes

- name: ensure Homebrew packages are the latest
  homebrew: name={{ item }} state=latest
  ignore_errors: yes
  with_items:
    - ack
    - aspell
    - autoconf
    - automake
    - bash-completion
    - bvi
    - bzr
    - cmake
    - cowsay
    - cscope
    - ctags
    - curl
    - dict
    - espeak
    - ffmpeg
    - fortune
    - gist
    - git
    - git-annex
    - gnupg
    - graphicsmagick
    - graphviz
    - hub
    - hydra
    - imagemagick
    - jpeg
    - jq
    - ledger
    - lorem
    - mcrypt
    - mercurial
    - mhash
    - mobile-shell
    - mongodb
    - mr
    - msmtp
    - mutt
    - mysql
    - ncftp
    - nmap
    - offline-imap
    - openssl
    - pandoc
    - parallel
    - pdftohtml
    - phantomjs
    - pkg-config
    - postgresql
    - proj
    - pwgen
    - rabbitmq
    - readline
    - reattach-to-user-namespace
    - redis
    - remind
    - rename
    - sl
    - sqlite
    - tig
    - tmux
    - tree
    - unrar
    - w3m
    - webp
    - wget

- name: ensure Homebrew Cask packages are the latest
  homebrew_cask: name={{ item }} state=present
  ignore_errors: yes
  with_items:
    - amethyst
    - boxer
    - caffeine
    - calibre
    - clamxav
    - coconutbattery
    - color-oracle
    - colors
    - disk-inventory-x
    - dockertoolbox
    - evernote
    - filezilla
    - firefox
    - firefoxdeveloperedition
    - flux
    - free-ruler
    - freemind
    - gifify
    - gog-galaxy
    - google-cloud-sdk
    - google-chrome-canary
    - google-earth-pro
    - google-refine
    - gpgtools
    - img2icns
    - itch
    - iterm2
    - java
    - karabiner
    - libreoffice
    - licecap
    - messenger
    - min
    - mongohub
    - nally
    - ngrok
    - nocturne
    - psequel
    - pngquant
    - rowanj-gitx
    - sequel-pro
    - skype
    - slack
    - telegram
    - temperature-monitor
    - the-unarchiver
    - tidy-html5
    - time-out
    - transmission
    - tunnelblick
    - typora
    - vagrant
    - virtualbox
    - vlc
    - wineskin-winery
    - wireshark
    - xquartz
    - zotero

- name: ensure Karabiner custom mappings are present
  copy: src=karabiner.xml dest="~/Library/Application Support/Karabiner/private.xml"
